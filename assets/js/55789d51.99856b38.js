"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[29051],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>b});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var m=n.createContext({}),d=function(e){var t=n.useContext(m),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},s=function(e){var t=d(e.components);return n.createElement(m.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,m=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),c=d(r),p=o,b=c["".concat(m,".").concat(p)]||c[p]||u[p]||a;return r?n.createElement(b,l(l({ref:t},s),{},{components:r})):n.createElement(b,l({ref:t},s))}));function b(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,l=new Array(a);l[0]=p;var i={};for(var m in t)hasOwnProperty.call(t,m)&&(i[m]=t[m]);i.originalType=e,i[c]="string"==typeof e?e:o,l[1]=i;for(var d=2;d<a;d++)l[d]=r[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},58676:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>m,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var n=r(87462),o=(r(67294),r(3905));const a={title:"NGram BloomFilter Index",language:"en"},l=void 0,i={unversionedId:"data-table/index/ngram-bloomfilter-index",id:"version-1.2/data-table/index/ngram-bloomfilter-index",title:"NGram BloomFilter Index",description:"\x3c!--",source:"@site/versioned_docs/version-1.2/data-table/index/ngram-bloomfilter-index.md",sourceDirName:"data-table/index",slug:"/data-table/index/ngram-bloomfilter-index",permalink:"/docs/1.2/data-table/index/ngram-bloomfilter-index",draft:!1,tags:[],version:"1.2",frontMatter:{title:"NGram BloomFilter Index",language:"en"},sidebar:"docs",previous:{title:"BloomFilter index",permalink:"/docs/1.2/data-table/index/bloomfilter"},next:{title:"Bitmap Index",permalink:"/docs/1.2/data-table/index/bitmap-index"}},m={},d=[{value:"Create Column With NGram BloomFilter Index",id:"create-column-with-ngram-bloomfilter-index",level:2},{value:"Show NGram BloomFilter Index",id:"show-ngram-bloomfilter-index",level:2},{value:"Drop NGram BloomFilter Index",id:"drop-ngram-bloomfilter-index",level:2},{value:"Add NGram BloomFilter Index",id:"add-ngram-bloomfilter-index",level:2},{value:"<strong>Some notes about Doris NGram BloomFilter</strong>",id:"some-notes-about-doris-ngram-bloomfilter",level:2}],s={toc:d},c="wrapper";function u(e){let{components:t,...r}=e;return(0,o.kt)(c,(0,n.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"experimental-ngram-bloomfilter-index"},"[Experimental]"," NGram BloomFilter Index"),(0,o.kt)("version",{since:"2.0.0"}),(0,o.kt)("p",null,"In order to improve the like query performance, the NGram BloomFilter index was implemented, which referenced to the ClickHouse's ngrambf skip indices;"),(0,o.kt)("h2",{id:"create-column-with-ngram-bloomfilter-index"},"Create Column With NGram BloomFilter Index"),(0,o.kt)("p",null,"During create table\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sql"},'CREATE TABLE `table3` (\n  `siteid` int(11) NULL DEFAULT "10" COMMENT "",\n  `citycode` smallint(6) NULL COMMENT "",\n  `username` varchar(100) NULL DEFAULT "" COMMENT "",\n  INDEX idx_ngrambf (`username`) USING NGRAM_BF PROPERTIES("gram_size"="3", "bf_size"="256") COMMENT \'username ngram_bf index\'\n) ENGINE=OLAP\nAGGREGATE KEY(`siteid`, `citycode`, `username`) COMMENT "OLAP"\nDISTRIBUTED BY HASH(`siteid`) BUCKETS 10\nPROPERTIES (\n"replication_num" = "1"\n);\n\n-- PROPERTIES("gram_size"="3", "bf_size"="1024")\uff0cindicate the number of gram and bytes of bloom filter respectively.\n-- the gram size set to same as the like query pattern string length. and the suitable bytes of bloom filter can be get by test, more larger more better, 256 maybe is a good start.\n-- Usually, if the data\'s cardinality is small, you can increase the bytes of bloom filter to improve the efficiency.\n')),(0,o.kt)("h2",{id:"show-ngram-bloomfilter-index"},"Show NGram BloomFilter Index"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sql"},"show index from example_db.table3;\n")),(0,o.kt)("h2",{id:"drop-ngram-bloomfilter-index"},"Drop NGram BloomFilter Index"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sql"},"alter table example_db.table3 drop index idx_ngrambf;\n")),(0,o.kt)("h2",{id:"add-ngram-bloomfilter-index"},"Add NGram BloomFilter Index"),(0,o.kt)("p",null,"Add NGram BloomFilter Index for old column:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sql"},'alter table example_db.table3 add index idx_ngrambf(username) using NGRAM_BF PROPERTIES("gram_size"="3", "bf_size"="512")comment \'username ngram_bf index\' \n')),(0,o.kt)("h2",{id:"some-notes-about-doris-ngram-bloomfilter"},(0,o.kt)("strong",{parentName:"h2"},"Some notes about Doris NGram BloomFilter")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"NGram BloomFilter only support CHAR/VARCHAR/String column."),(0,o.kt)("li",{parentName:"ol"},"NGram BloomFilter index and BloomFilter index should be exclusive on same column"),(0,o.kt)("li",{parentName:"ol"},"The gram number and bytes of BloomFilter can be adjust and optimize. Like if gram is too small, you can increase the bytes of BloomFilter."),(0,o.kt)("li",{parentName:"ol"},"To find some query whether use the NGram BloomFilter index, you can check the query profile.")))}u.isMDXComponent=!0}}]);